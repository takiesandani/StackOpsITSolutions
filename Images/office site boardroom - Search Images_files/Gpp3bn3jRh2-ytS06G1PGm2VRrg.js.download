var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},ImageDetailReducers,ImageDetailActions,Multimedia;(function(n){var t;(function(n){var t=function(){function n(n){this.load=n.invoker;this.isRequestAllowed=n.isRequestAllowed;this.onErrorCallback=n.onErrorCallback;this.onSuccessCallback=n.onSuccessCallback}return n.prototype.loadAssets=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(u){switch(u.label){case 0:if(this.isRequestAllowed&&!this.isRequestAllowed(n))return[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.load.apply(this,__spreadArray([n],i,!1))];case 2:if(t=u.sent(),this.onSuccessCallback)this.onSuccessCallback(t);return[2,t];case 3:if(r=u.sent(),this.onErrorCallback)this.onErrorCallback(r);return[2,null];case 4:return[2]}})})},n}();n.createLoader=function(n){return new t(n)}})(t=n.ResourceOndemandLoader||(n.ResourceOndemandLoader={}))})(Multimedia||(Multimedia={})),function(n){function t(n,t){switch(t.type){case ImageDetailActions.CHANGE_ONDEMAND_RESOURCE_STATUS:return Object.assign({},n,t.payload||{});default:return n}}function i(n,t,i){switch(t.type){case ImageDetailActions.ONDEMAND_RESOURCE_FETCH_REQUESTED:var r=Object.assign({},n);return r[i]=Object.assign({},n[i],{nextOnDemandLoadSfx:n[i].nextOnDemandLoadSfx?n[i].nextOnDemandLoadSfx+1:2}),r;default:return n}}function r(n,t){var i;if((i=n.onDemandResourceStatus)!==null&&i!==void 0)return i[t]}n.uodrs=t;n.godrs=r;n.uirsd=i}(ImageDetailReducers||(ImageDetailReducers={})),function(n){n.CHANGE_ONDEMAND_RESOURCE_STATUS="CHANGE_ONDEMAND_RESOURCE_STATUS";n.ONDEMAND_RESOURCE_FETCH_REQUESTED="ONDEMAND_RESOURCE_FETCH_REQUESTED";var t=function(t){return{type:n.CHANGE_ONDEMAND_RESOURCE_STATUS,payload:t}},i=function(){return{type:n.ONDEMAND_RESOURCE_FETCH_REQUESTED}};n.codrs=t;n.cofrra=i}(ImageDetailActions||(ImageDetailActions={}));__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})};__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},function(n){var t;(function(t){var i;(function(t){var r=this,u=n.Utils,i,f=function(){if(!i){var n=_ge("b_dmcf"),t=n&&n.getAttribute("data-dmcf");if(!t)return;try{i=JSON.parse(t);n.removeAttribute("data-dmcf")}catch(r){i=undefined}}return i};t.fetchOnDemandResources=function(n,t){var i=t===void 0?{}:t,e=i.ig,o=i.sfx;return __awaiter(r,void 0,void 0,function(){var t,i,r,s;return __generator(this,function(){return(t=f(),!((t===null||t===void 0?void 0:t.dmurl)&&e&&o))?[2,Promise.reject()]:(i=window.location.origin,r=u.sf(t.dmurl,e),s="".concat(i).concat(r,"&SFX=").concat(o),[2,fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assets:n})}).then(function(n){return n.text()})])})})}})(i=t.OnDemand||(t.OnDemand={}))})(t=n.Utils||(n.Utils={}))}(Multimedia||(Multimedia={})),function(n){var t;(function(n){function r(n){var r=ImageDetailReducers.gmcm(),u=i(function(){var n=[];return r&&Object.keys(r).forEach(function(t){var i=r[t];i&&i.drsn&&n.push(i)}),n},[r]);return t(function(){var r=n.fetchOnDemandResources,i=[],t;n.currentInsightsRequestState===SharedInterfaces.RequestState.Success&&(t=n.insightState,u.forEach(function(r){var u;n.currentInsightsId&&((u=t===null||t===void 0?void 0:t.data)===null||u===void 0?void 0:u[r.dk])&&i.push(r.drsn)}));i.length>0&&r(i)},[n.currentInsightsId,n.currentInsightsRequestState,n.insightState,u]),null}var t=React.useEffect,i=React.useMemo,u=function(n){var t=ImageDetailReducers.getInsightsState(n),i=ImageDetailReducers.getDisplayInsightsId(n);return{currentInsightsRequestState:t===null||t===void 0?void 0:t.requestState,currentInsightsId:i,insightState:t}},f=ReactRedux.connect(u);n.ModuleOnDemandProvider=f(r)})(t=n.ImageDetail||(n.ImageDetail={}))}(Multimedia||(Multimedia={})),function(n){var t;(function(t){function r(t){var i=function(i){var r,u=((r=t.instrumentationSfxData)===null||r===void 0?void 0:r.nextOnDemandLoadSfx)||1;return t.changeResourceFetchRequestedAction(),n.Utils.OnDemand.loadAssets(i,{ig:t.ig,sfx:u})};return React.createElement(React.Fragment,null,React.createElement(n.ImageDetail.ModuleOnDemandProvider,{fetchOnDemandResources:i}))}var i=ImageDetailReducers,u=function(n){var t,u=i.getDisplayInsightsId(n),r=i.getCurrentImpressionId(n),f=(t=i.getInstSfxData(n))===null||t===void 0?void 0:t[r];return{currentInsightsId:u,instrumentationSfxData:f,ig:r}},f=function(n){return{changeResourceFetchRequestedAction:function(){n(ImageDetailActions.cofrra())}}},e=ReactRedux.connect(u,f);t.OnDemandFacade=e(r)})(t=n.ImageDetail||(n.ImageDetail={}))}(Multimedia||(Multimedia={}));__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})};__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},function(n){var t;(function(t){var i;(function(t){function o(){var n,t,i=new Promise(function(i,r){n=i;t=r});return{promise:i,resolve:n,reject:t}}function h(n,t){return __awaiter(this,void 0,void 0,function(){var o,e,c,h,l;return __generator(this,function(a){switch(a.label){case 0:return[4,r.promise];case 1:if(o=a.sent(),e=s(n),!(o&&e.length>0))return[3,6];a.label=2;case 2:return a.trys.push([2,4,,5]),c=o.loadAssets(e,t),ImageDetailStore.store.dispatch(ImageDetailActions.codrs(f(e,i.Pending))),[4,c];case 3:return(h=a.sent(),typeof sj_appHTML!="undefined"&&h)?(sj_appHTML(document.body,h),u(e.map(function(n){return{resourceKey:n}})),[2,!0]):[3,5];case 4:return l=a.sent(),[3,5];case 5:ImageDetailStore.store.dispatch(ImageDetailActions.codrs(f(e,i.Failed)));a.label=6;case 6:return[2,!1]}})})}function u(n){ImageDetailStore.store.dispatch(ImageDetailActions.codrs(f(n.map(function(n){return n.resourceKey}),i.Success)))}function f(n,t){for(var f,r={},i=0,u=n;i<u.length;i++)f=u[i],r[f]=t;return r}function s(n){for(var r,u,f=[],t=0,e=n;t<e.length;t++)r=e[t],u=ImageDetailReducers.godrs(ImageDetailStore.store.getState(),r),u&&u!==i.Failed||f.push(r);return f}var i=SharedInterfaces.RequestState,r,e;t.createDeferredPromise=o;r=o();t.loadAssets=h;t.updateSuccessfullyLoadedAssets=u;e=n.ResourceOndemandLoader.createLoader;e&&(r.resolve(e({invoker:n.Utils.OnDemand.fetchOnDemandResources,isRequestAllowed:function(n){return s(n).length>0}})),u([{resourceKey:"dm-loader"}]))})(i=t.OnDemand||(t.OnDemand={}))})(t=n.Utils||(n.Utils={}))}(Multimedia||(Multimedia={}))